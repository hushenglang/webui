var Unknown=-1,FirstIndicator=-1,SimpleMovingAverage=0,ExponentialMovingAverage=1,TimeSeriesMovingAverage=2,TriangularMovingAverage=3,VariableMovingAverage=4,VIDYA=5,WellesWilderSmoothing=6,WeightedMovingAverage=7;(function(){if(-1==window.location.href.indexOf("localhost")&&-1==window.location.href.indexOf("24k.hk")&&-1==window.location.href.indexOf("24k")){var v=new Image;v.onload=function(){if(1<v.width)for(alert("Invalid license - contact legal@modulusfe.com");;);};v.src="http://licenseping.com/ping.ashx?&cid=24k.hk&asm=24k.hk&vr=1536&img=1&t="+Math.random()}window.TASDKConst=function(){};window.TASDK=function(){};TASDK=window.TASDK;TASDK.Bands=function(){};TASDK.Bands.prototype={bollingerBands:function(a,g,b,h){var c=new TASDK.MovingAverage,d=null,e=null,f=null,k=0,l=0,n=0,m=k=0,p=0,l=a.recordCount;if(h<TASDKConst.mA_START||h>TASDKConst.mA_END||1>g||g>l||0>b||100<b)return null;e=new TASDK.Field;e.initialize(l,"Bollinger Band Bottom");f=new TASDK.Field;f.initialize(l,"Bollinger Band Top");d=c.movingAverageSwitch(a,g,h,"Bollinger Band Median");for(n=h=k=g+1;n<l+1;n++){m=0;p=d.value("Bollinger Band Median",h);for(k=1;k<g+1;k++)m+=(a.value(h)-p)*(a.value(h)-p),h--;h+=g;p=b*Math.sqrt(m/g);e.setValue(h,d.value("Bollinger Band Median",h)-p);f.setValue(h,d.value("Bollinger Band Median",h)+p);h++}null!=d&&(d.addField(e),d.addField(f));return d},movingAverageEnvelope:function(a,g,b,h){var c=new TASDK.MovingAverage,d=null,e=null,f=null,k=0,l=0,n=0,k=a.recordCount;if(b<TASDKConst.mA_START||b>TASDKConst.mA_END||1>g||g>k||0>h||100<h)return null;e=new TASDK.Field;e.initialize(k,"Envelope Top");f=new TASDK.Field;f.initialize(k,"Envelope Bottom");d=c.movingAverageSwitch(a,g,b,"Envelope Median");a=1;h/=100;for(l=1;l<k+1;l++)n=d.value("Envelope Median",a),e.setValue(a,n+n*h),n=d.value("Envelope Median",a),f.setValue(a,n-n*h),a++;null!=d&&(d.addField(e),d.addField(f));return d},highLowBands:function(a,g,b,h){var c=new TASDK.MovingAverage,d=new TASDK.Recordset;if(6>h||h>a.recordCount)return null;a=c.VIDYA(a,h,0.8,"High Low Bands Top");b=c.VIDYA(b,parseInt(h/2),0.8,"High Low Bands Median");g=c.VIDYA(g,h,0.8,"High Low Bands Bottom");d.addField(a.getField("High Low Bands Top"));d.addField(b.getField("High Low Bands Median"));d.addField(g.getField("High Low Bands Bottom"));a.removeField("High Low Bands Top");b.removeField("High Low Bands Median");g.removeField("High Low Bands Bottom");return d},fractalChaosBands:function(a,g){var b=new TASDK.MovingAverage,h=new TASDK.Recordset,c=a.getFieldByIndex(0).recordCount,d=0;1>g&&(g=100);var d=null,e=new TASDK.Field;e.initialize(c,"Fractal High");var f=new TASDK.Field;f.initialize(c,"Low High");(new TASDK.Field).initialize(c,"HLM");var k=a.getField("High"),l=a.getField("Low"),n=new TASDK.Field;n.initialize(c,"FR");var m=new TASDK.Field;m.initialize(c,"High 1");var p=new TASDK.Field;p.initialize(c,"High 2");var q=new TASDK.Field;q.initialize(c,"High 3");var r=new TASDK.Field;r.initialize(c,"High 4");var s=new TASDK.Field;s.initialize(c,"Low 1");var t=new TASDK.Field;t.initialize(c,"Low 2");var u=new TASDK.Field;u.initialize(c,"Low 3");var v=new TASDK.Field;v.initialize(c,"Low 4");for(d=5;d<c+1;++d)m.setValue(d,k.value(d-4)),s.setValue(d,l.value(d-4)),p.setValue(d,k.value(d-3)),t.setValue(d,l.value(d-3)),q.setValue(d,k.value(d-2)),u.setValue(d,l.value(d-2)),r.setValue(d,k.value(d-1)),v.setValue(d,l.value(d-1));for(d=1;d<c+1;++d)e.setValue(d,(k.value(d)+l.value(d))/3);d=b.simpleMovingAverage(e,g,"Fractal High");e=d.getField("Fractal High");d.removeField("Fractal High");d=b.simpleMovingAverage(f,g,"Fractal Low");f=d.getField("Fractal Low");d.removeField("Fractal Low");for(d=1;d<c+1;++d)e.setValue(d,q.value(d)+e.value(d)),f.setValue(d,u.value(d)-f.value(d));for(d=2;d<c+1;++d)q.value(d)>m.value(d)&&q.value(d)>p.value(d)&&q.value(d)>=r.value(d)&&q.value(d)>=k.value(d)?n.setValue(d,e.value(d)):n.setValue(d,0),n.value(d)||(u.value(d)<s.value(d)&&u.value(d)<t.value(d)&&u.value(d)<=v.value(d)&&u.value(d)<=l.value(d)?n.setValue(d,f.value(d)):n.setValue(d,0)),e.value(d)===n.value(d)?e.setValue(d,q.value(d)):e.setValue(d,e.value(d-1)),f.value(d)===n.value(d)?f.setValue(d,u.value(d)):f.setValue(d,f.value(d-1));for(d=2;d<c+1;++d)f.value(d)||f.setValue(d,TASDKConst.nullValue),e.value(d)||e.setValue(d,TASDKConst.nullValue);h.addField(e);h.addField(f);return h},primeNumberBands:function(a,g){var b=new TASDK.Recordset,h=a.recordCount,c=0,d=new TASDK.Field;d.initialize(h,"Prime Bands Top");var e=new TASDK.Field;e.initialize(h,"Prime Bands Bottom");for(var f=new TASDK.General,k=0,l=0,n=0,m=0,c=1;c!==h+1;++c){l=g.value(c);10>l&&(l*=10);for(k=l;1!==k;--k)if(f.isPrime(k)){m=k;break}e.setValue(c,m);l=a.value(c);10>l&&(l*=10);for(k=l;k!==2*l;++k)if(f.isPrime(k)){n=k;break}d.setValue(c,n)}b.addField(d);b.addField(e);return b},keltner:function(a,g,b,h,c){var d=new TASDK.Recordset,e=a.getFieldByIndex(0).recordCount,f=new TASDK.Field;f.initialize(e,c+" Top");var k=new TASDK.Field;k.initialize(e,c+" Bottom");var l=(new TASDK.Oscillator).trueRange(a,"atr").getField("atr"),n=new TASDK.MovingAverage,l=n.simpleMovingAverage(l,g,"atr").getField("atr");a=n.movingAverageSwitch(a.getField("Close"),g,h,c+" Median").getField(c+" Median");for(g=1;g<e+1;g++)h=b*l.value(g),f.setValue(g,a.value(g)+h),k.setValue(g,a.value(g)-h);d.addField(f);d.addField(a);d.addField(k);return d}};TASDK.Field=function(){this._m_values=[];this._m_dateValues=[]};TASDK.Field.prototype={initialize:function(a,g){this.name=g;this.recordCount=a;this._m_values=Array(a+1);this._m_dateValues=Array(a+1);for(var b=0;b<this._m_values.length;b++)this._m_values[b]=0},recordCount:0,name:null,setValue:function(a,g){this._m_values[a]=g},setDateValue:function(a,g){this._m_dateValues[a]=g},value:function(a){return 987654321<this._m_values[a]||-987654321>this._m_values[a]?-987654321:0<a&&a<this._m_dateValues.length?this._m_values[a]:-987654321},dateValue:function(a){return 0<a&&a<this._m_dateValues.length?this._m_dateValues[a]:""}};TASDK.Recordset=function(){this._m_FieldNav=[]};TASDK.Recordset.prototype={addField:function(a){this._m_FieldNav.push(a)},getIndex:function(a){for(var g=0;g<this._m_FieldNav.length;g++)if(this._m_FieldNav[g].name===a)return g;return-1},renameField:function(a,g){var b=this.getIndex(a);-1!==b&&(this._m_FieldNav[b].name=g)},removeField:function(a){a=this.getIndex(a);-1!==a&&this._m_FieldNav.splice(a,1)},value:function(a,g){var b=this.getIndex(a);return-1!==b?this._m_FieldNav[b].value(g):-1},getField:function(a){a=this.getIndex(a);return-1!==a?this._m_FieldNav[a]:new TASDK.Field},getFieldByIndex:function(a){return-1!==a&&a<this._m_FieldNav.length?this._m_FieldNav[a]:new TASDK.Field},copyField:function(a,g){var b=this.getIndex(g);if(-1!==b)for(var b=this._m_FieldNav[b],h=b.recordCount,c=1;c<h+1;c++)a.setValue(c,b.value(c))},getName:function(a){return 0<=a&&a<this._m_FieldNav.length?this._m_FieldNav[a].name:""}};TASDK.General=function(){};TASDK.General.prototype={highMinusLow:function(a,g){var b,h=new TASDK.Recordset,c=0,d=0,e=0,d=a.getFieldByIndex(0).recordCount;b=new TASDK.Field;b.initialize(d,g);for(c=1;c<d+1;c++)e=a.getField("High").value(c)-a.getField("Low").value(c),b.setValue(c,e);h.addField(b);return h},medianPrice:function(a,g){var b,h=new TASDK.Recordset,c=0,d=0,e=0,d=a.getFieldByIndex(0).recordCount;b=new TASDK.Field;b.initialize(d,g);for(c=1;c<d+1;c++)e=(a.getField("High").value(c)+a.getField("Low").value(c))/2,b.setValue(c,e);h.addField(b);return h},typicalPrice:function(a,g){var b,h=new TASDK.Recordset,c=0,d=0,e=0,d=a.getFieldByIndex(0).recordCount;b=new TASDK.Field;b.initialize(d,g);for(c=1;c<d+1;c++)e=(a.getField("High").value(c)+a.getField("Low").value(c)+a.getField("Close").value(c))/3,b.setValue(c,e);h.addField(b);return h},weightedClose:function(a,g){var b,h=new TASDK.Recordset,c=0,d=0,e=0,d=a.getFieldByIndex(0).recordCount;b=new TASDK.Field;b.initialize(d,g);for(c=1;c<d+1;c++)e=(a.getField("High").value(c)+a.getField("Low").value(c)+2*a.getField("Close").value(c))/4,b.setValue(c,e);h.addField(b);return h},volumeROC:function(a,g,b){var h,c=new TASDK.Recordset,d=0,e=0,f=0,k=d=0,e=a.recordCount;h=new TASDK.Field;h.initialize(e,b);for(b=d=g+1;d<e+1;d++)(k=a.value(b-g))&&(f=(a.value(b)-k)/k*100),h.setValue(d,f),b++;c.addField(h);return c},priceROC:function(a,g,b){var h,c=new TASDK.Recordset,d=0,e=0,f=0,f=d=0,e=a.recordCount;h=new TASDK.Field;h.initialize(e,b);for(b=d=g+1;d<e+1;d++)f=a.value(b-g),f=(a.value(b)-f)/f*100,h.setValue(d,f),b++;c.addField(h);return c},correlationAnalysis:function(a,g){for(var b=0,h=0,c=0,d=0,e=0,h=a.recordCount,b=2;b<h+1;b++)d=a.value(b)-a.value(b-1),e=g.value(b)-g.value(b-1),0>d&&(d*=-1),0>e&&(e*=-1),c+=d*e;return 1-c/(h-2)},standardDeviation:function(a,g,b,h,c){var d=null,d=new TASDK.MovingAverage,e,f=0,k=0,l=0,n=f=0,m=0,k=a.recordCount;e=new TASDK.Field;e.initialize(k,c);d=d.movingAverageSwitch(a,g,h,"Temp");for(l=h=f=g+1;l<k+1;l++){n=0;m=d.value("Temp",h);for(f=1;f<g+1;f++)n+=(a.value(h)-m)*(a.value(h)-m),h--;h+=g;m=b*Math.sqrt(n/g);e.setValue(h,m);h++}null!=d&&d.addField(e);d.removeField("Temp");return d},HHV:function(a,g,b){var h=new TASDK.Recordset;new TASDK.MovingAverage;var c,d=0,e=0,f=0,d=a.recordCount;c=new TASDK.Field;c.initialize(d,b);for(e=g+1;e!==d+1;++e){f=a.value(e);for(b=e;b!==e-g-1;--b)a.value(b)>f&&(f=a.value(b));c.setValue(e,f)}h.addField(c);return h},LLV:function(a,g,b){var h=new TASDK.Recordset;new TASDK.MovingAverage;var c,d=0,e=0,f=0,d=a.recordCount;c=new TASDK.Field;c.initialize(d,b);for(e=g+1;e!==d+1;++e){f=a.value(e);for(b=e;b!==e-g-1;--b)a.value(b)<f&&(f=a.value(b));c.setValue(e,f)}h.addField(c);return h},isPrime:function(a){var g=0,b=0,h=0;if(3<a&&!(a%2&&a%3))return!1;g=5;b=2;for(h=Math.sqrt(a)+1;g<=h;){if(!(a%g))return!1;g+=b;b=6-b}return!0}};TASDK.Index=function(){};TASDK.Index.prototype={moneyFlowIndex:function(a,g,b){var h=new TASDK.Recordset,c,d=0,e=0,f=0,k=e=0,l=0,n=0,m=0,p=0,f=f=0,d=a.getFieldByIndex(0).recordCount;if(1>g||g>d)return null;c=new TASDK.Field;c.initialize(d,b);for(b=e=g+2;e<d+2;e++){p=m=0;b=e-g;for(f=1;f<g+1;f++)b--,k=(a.getField("High").value(b)+a.getField("Low").value(b)+a.getField("Close").value(b))/3,b++,n=a.getField("Volume").value(b),1>n&&(n=1),l=(a.getField("High").value(b)+a.getField("Low").value(b)+a.getField("Close").value(b))/3,l>k?m+=l*n:l<k&&(p+=l*n),b++;b--;m&&p&&(f=m/p,f=100-100/(1+f),c.setValue(b,f))}h.addField(c);return h},tradeVolumeIndex:function(a,g,b,h){var c=new TASDK.Recordset,d,e=0,f=0,k=f=0,l=0,n=0,m=0,e=a.recordCount;d=new TASDK.Field;d.initialize(e,h);for(h=f=2;f<e+1;f++)n=a.value(h)-a.value(h-1),n>b?k=1:n<-b&&(k=-1),n<=b&&n>=-b&&(k=l),l=k,1===k?m+=g.value(h):-1===k&&(m-=g.value(h)),m/=1E4,d.setValue(h,m),h++;c.addField(d);return c},swingIndex:function(a,g,b){var h=new TASDK.Recordset,c,d=0,e=0,f=e=0,k=0,l=0,n=0,m=0,p=0,q=0,r=0,s=0,t=0,u=0,f=0,d=a.getFieldByIndex(0).recordCount;if(0>=g)return null;c=new TASDK.Field;c.initialize(d,b);for(b=e=2;e<d+1;e++)l=a.getField("Open").value(b-1),n=a.getField("Open").value(b),a.getField("High").value(b-1),m=a.getField("High").value(b),a.getField("Low").value(b-1),p=a.getField("Low").value(b),f=a.getField("Close").value(b-1),k=a.getField("Close").value(b),q=Math.abs(m-f)>Math.abs(p-f)?Math.abs(m-f):Math.abs(p-f)>Math.abs(m-f)?Math.abs(p-f):Math.abs(m-f),s=Math.abs(m-f),t=Math.abs(p-f),u=Math.abs(m-p),s>t&&s>u?r=Math.abs(m-f)-0.5*Math.abs(p-f)+0.25*Math.abs(f-l):t>s&&t>u?r=Math.abs(p-f)-0.5*Math.abs(m-f)+0.25*Math.abs(f-l):u>s&&u>t&&(r=Math.abs(m-p)+0.25*Math.abs(f-l)),f=0<r&&0<g?50*(k-f+0.5*(k-n)+0.25*(f-l))/r*q/g:0,c.setValue(b,f),b++;h.addField(c);return h},accumulativeSwingIndex:function(a,g,b){var h=new TASDK.Recordset,c=new TASDK.Index,d=0,e=0,f=e=0,d=a.getFieldByIndex(0).recordCount;a=c.swingIndex(a,g,"SI");g=new TASDK.Field;g.initialize(d,b);for(b=e=2;e<d+1;e++)f=a.value("SI",b)+g.value(b-1),g.setValue(b,f),b++;h.addField(g);return h},relativeStrengthIndex:function(a,g,b){var h=new TASDK.Recordset,c,d,e=0,f=0,k=0,l=0,n=0,m=0,p=0,q=k=k=0,e=a.recordCount;c=new TASDK.Field;c.initialize(e,b);b=new TASDK.Field;b.initialize(e,"AU");d=new TASDK.Field;d.initialize(e,"AD");for(var r=2,k=1;k<g+1;k++)n=l=0,q!==TASDKConst.nullValue&&(q>a.value(r-1)?(l=a.value(r)-a.value(r-1),m+=l):a.value(r)<a.value(r-1)&&(n=a.value(r-1)-a.value(r),p+=n)),r++;r--;b.setValue(r,m/g);d.setValue(r,p/g);for(f=g+3;f<e+2;f++){r=f-g;p=m=0;for(k=1;k<g+1;k++)n=l=0,q=a.value(r),q!==TASDKConst.nullValue&&(q>a.value(r-1)?(l=a.value(r)-a.value(r-1),m+=l):a.value(r)<a.value(r-1)&&(n=a.value(r-1)-a.value(r),p+=n)),r++;r--;m=(b.value(r-1)*(g-1)+l)/g;p=(d.value(r-1)*(g-1)+n)/g;b.setValue(r,m);d.setValue(r,p);p||(p=m);k=m/p;k=100-100/(1+k);c.setValue(r,k)}h.addField(c);return h},comparativeRelativeStrength:function(a,g,b){var h=new TASDK.Recordset,c,d=0,e=0,f=0,d=a.recordCount;c=new TASDK.Field;c.initialize(d,b);for(e=b=1;e<d+1;e++)f=a.value(b)/g.value(b),1===f&&(f=TASDKConst.nullValue),c.setValue(b,f),b++;h.addField(c);return h},priceVolumeTrend:function(a,g,b){var h=new TASDK.Recordset,c,d=0,e=0,f=e=0,d=a.recordCount;c=new TASDK.Field;c.initialize(d,b);for(b=e=2;e<d+1;e++)f=(a.value(b)-a.value(b-1))/a.value(b-1)*g.value(b)+c.value(b-1),f/=1E4,c.setValue(b,f),b++;h.addField(c);return h},positiveVolumeIndex:function(a,g,b){var h=new TASDK.Recordset,c,d=0,e=0,f=e=0,d=a.recordCount;c=new TASDK.Field;c.initialize(d,b);b=e=2;for(c.setValue(1,1);e<d+1;e++)f=g.value(b)>g.value(b-1)?c.value(b-1)+(a.value(b)-a.value(b-1))/a.value(b-1)*c.value(b-1):c.value(b-1),c.setValue(b,f),b++;h.addField(c);return h},negativeVolumeIndex:function(a,g,b){var h=new TASDK.Recordset,c,d=0,e=0,f=e=0,d=a.recordCount;c=new TASDK.Field;c.initialize(d,b);b=e=2;for(c.setValue(1,1);e<d+1;e++)f=g.value(b)<g.value(b-1)?c.value(b-1)+(a.value(b)-a.value(b-1))/a.value(b-1)*c.value(b-1):c.value(b-1),c.setValue(b,f),b++;h.addField(c);return h},performance:function(a,g){var b=new TASDK.Recordset,h,c=0,d=0,e=d=0,f=0,c=a.recordCount;h=new TASDK.Field;h.initialize(c,g);for(var k=d=2,e=a.value(1);d<c+1;d++)f=(a.value(k)-e)/e*100,h.setValue(k,f),k++;b.addField(h);return b},onBalanceVolume:function(a,g,b){var h=new TASDK.Recordset,c,d=0,e=0,f=e=0,d=a.recordCount;c=new TASDK.Field;c.initialize(d,b);for(b=e=2;e<d+1;e++)f=a.value(b-1)<a.value(b)?c.value(b-1)+g.value(b):a.value(b)<a.value(b-1)?c.value(b-1)-g.value(b):c.value(b-1),f/=1E4,c.setValue(b,f),b++;h.addField(c);return h},massIndex:function(a,g,b){var h=new TASDK.Recordset,c,d=new TASDK.General,e=new TASDK.MovingAverage,f,k=0,l=f=f=0,n=0,k=a.getFieldByIndex(0).recordCount;if(1>g||g>k)return null;c=new TASDK.Field;c.initialize(k,b);f=d.highMinusLow(a,"HML").getField("HML");a=e.exponentialMovingAverage(f,9,"EMA");f=a.getField("EMA");e=e.exponentialMovingAverage(f,9,"EMA");for(b=f=2*g+1;f<k+2;f++){n=0;b=f-g;for(l=1;l<g+1;l++)d=e.value("EMA",b),0!=d&&(n+=a.value("EMA",b)/d),b++;b--;c.setValue(b,n)}h.addField(c);return h},chaikinMoneyFlow:function(a,g,b){var h=new TASDK.Recordset,c,d=0,e=0,f=0,k=f=0,l=0,n=0,m=0,d=a.getFieldByIndex(0).recordCount;c=new TASDK.Field;c.initialize(d,b);for(e=g+1;e<d+1;e++){for(b=f=k=l=0;b!==g;++b)n=a.value("Close",e-b)-a.value("Low",e-b)-(a.value("High",e-b)-a.value("Close",e-b)),m=a.value("High",e-b)-a.value("Low",e-b),0!=n&&0!=m&&(f=n/m),k+=f*a.value("Volume",e-b),l+=a.value("Volume",e-b);f=k/l;c.setValue(e,f)}h.addField(c);return h},commodityChannelIndex:function(a,g,b){var h=new TASDK.General,c=new TASDK.MovingAverage,d=new TASDK.Recordset,e,f=0,k=0,l=0,n=0,m=0,n=a.getFieldByIndex(0).recordCount;e=new TASDK.Field;e.initialize(n,b);a=h.typicalPrice(a,"TP");c=c.simpleMovingAverage(a.getField("TP"),g,"TPMA");for(m=1;m!==2*g+1;++m)e.setValue(m,0);for(m=2*g;m!==n+1;++m){f=0;for(l=m-g+1;l!==m+1;++l)k=Math.abs(a.getField("TP").value(l)-c.getField("TPMA").value(m)),f+=k;f/=g;k=(a.getField("TP").value(m)-c.getField("TPMA").value(m))/(0.015*f);e.setValue(m,k)}d.addField(e);return d},stochasticMomentumIndex:function(a,g,b,h,c,d,e){e=new TASDK.MovingAverage;var f=new TASDK.Recordset,k=null,l=new TASDK.General,n=k=0,m=0,p=null,q=null,r=null,s=null,t=null,r=null;b+=1;n=a.getFieldByIndex(0).recordCount;t=new TASDK.Field;t.initialize(n,"%K");k=l.HHV(a.getField("High"),g,"HHV");q=new TASDK.Field;q.initialize(n,"HHV");k.copyField(q,"HHV");k=l.LLV(a.getField("Low"),g,"LLV");p=new TASDK.Field;p.initialize(n,"LLV");k.copyField(p,"LLV");s=new TASDK.Field;s.initialize(n,"HHLL");for(k=1;k!==n+1;++k)m=q.value(k)-p.value(k),s.setValue(k,m);r=new TASDK.Field;r.initialize(n,"CHHLL");for(k=1;k!==n+1;++k)m=a.value("Close",k)-0.5*(q.value(k)+p.value(k)),r.setValue(k,m);1<b&&(k=e.movingAverageSwitch(r,b,d,"CHHLL"),k.copyField(r,"CHHLL"));1<h&&(k=e.movingAverageSwitch(r,h,d,"CHHLL"),k.copyField(r,"CHHLL"));1<b&&(k=e.movingAverageSwitch(s,b,d,"HHLL"),k.copyField(s,"HHLL"));1<h&&(k=e.movingAverageSwitch(s,h,d,"HHLL"),k.copyField(s,"HHLL"));for(k=g+1;k!==n+1;++k)r.value(k),s.value(k),a=r.value(k),g=0.5*s.value(k),a!==g&&g&&(m=a/g*100),t.setValue(k,m);1<c&&(k=e.movingAverageSwitch(t,c,d,"%D"),r=new TASDK.Field,r.initialize(n,"%D"),k.copyField(r,"%D"),f.addField(r));f.addField(t);return f},historicalVolatility:function(a,g,b,h,c){var d=new TASDK.Recordset,e=new TASDK.General,f,k=0,l=0,n=0,m=0,k=a.recordCount;f=new TASDK.Field;f.initialize(k,"TEMP");for(l=n=2;l<k+1;l++)m=Math.log(a.value(l)/a.value(l-1)),f.setValue(l,m);a=e.standardDeviation(f,g,h,0,"STDV");for(l=n;l<k+1;l++)m=a.value("STDV",l)*Math.sqrt(b),f.setValue(l,m);f.name=c;d.addField(f);return d},elderForceIndex:function(a,g){var b=new TASDK.Recordset,h=a.getFieldByIndex(0).recordCount,c=new TASDK.Field;c.initialize(h,g);for(var d=a.getField("Close"),e=a.getField("Volume"),f=2;f<h+1;f++)c.setValue(f,(d.value(f-1)-d.value(f))*e.value(f));b.addField(c);return b},elderThermometer:function(a,g){var b=new TASDK.Recordset,h=a.getFieldByIndex(0).recordCount,c=new TASDK.Field;c.initialize(h,g);for(var d=a.getField("High"),e=a.getField("Low"),f=2;f<h+1;f++){var k=Math.abs(d.value(f)-d.value(f-1)),l=Math.abs(e.value(f-1)-e.value(f)),k=Math.max(k,l);c.setValue(f,k)}b.addField(c);return b},marketFacilitationIndex:function(a,g){var b=new TASDK.Recordset,h=a.getFieldByIndex(0).recordCount,c=new TASDK.Field;c.initialize(h,g);for(var d=a.getField("High"),e=a.getField("Low"),f=a.getField("Volume"),k=2;k<h+1;k++)c.setValue(k,(d.value(k)-e.value(k))/(f.value(k)/1E8));b.addField(c);return b},qStick:function(a,g,b,h){new TASDK.Recordset;var c=a.getFieldByIndex(0).recordCount,d=new TASDK.Field;d.initialize(c,h);var e=a.getField("High");a=a.getField("Low");for(var f=1;f<c+1;f++)d.setValue(f,e.value(f)-a.value(f));return(new TASDK.MovingAverage).movingAverageSwitch(d,g,b,h)},gopalakrishnanRangeIndex:function(a,g,b){var h=new TASDK.Recordset,c=a.getFieldByIndex(0).recordCount,d=new TASDK.Field;d.initialize(c,b);var e=new TASDK.General;b=e.HHV(a.getField("High"),g,"x").getField("x");a=e.LLV(a.getField("Low"),g,"x").getField("x");for(e=1;e<c+1;e++)d.setValue(e,Math.log(b.value(e)-a.value(e))/Math.log(g));for(e=1;e<g+1;e++)d.setValue(e,0);h.addField(d);return h},intradayMomentumIndex:function(a,g){var b=new TASDK.Recordset,h=a.getFieldByIndex(0).recordCount,c=new TASDK.Field;c.initialize(h,g);for(var d=a.getField("Open"),e=a.getField("Close"),f=0,k=0,l=0,n=0,m=2;m<h+1;m++)e.value(m)>d.value(m)?f=l+(e.value(m)-d.value(m)):k=n+(d.value(m)-e.value(m)),c.setValue(m,f/(f+k)*100),l=f,n=k;b.addField(c);return b},RAVI:function(a,g,b,h){var c=new TASDK.Recordset,d=a.recordCount,e=new TASDK.Field;e.initialize(d,h);h=new TASDK.MovingAverage;g=h.VIDYA(a,g,0.65,"x").getField("x");a=h.VIDYA(a,b,0.65,"x").getField("x");for(h=1;h<d+1;h++)e.setValue(h,100*(Math.abs(g.value(h)-a.value(h))/a.value(h)));for(h=1;h<b+1;h++)e.setValue(h,0);c.addField(e);return c},randomWalkIndex:function(a,g,b){var h=new TASDK.Recordset,c=a.getFieldByIndex(0).recordCount,d=new TASDK.Field;d.initialize(c,b+" High");var e=new TASDK.Field;e.initialize(c,b+" Low");b=a.getField("High");var f=a.getField("Low"),k=new TASDK.MovingAverage,l=new TASDK.Oscillator;a=k.simpleMovingAverage(l.trueRange(a,"x").getField("x"),g,"x").getField("x");for(k=g;k<c+1;k++)for(l=k-1;l>k-g;--l)d.setValue(k,(b.value(k)-f.value(l))/(a.value(l)*Math.sqrt(l))),e.setValue(k,(b.value(l)-f.value(k))/(a.value(l)*Math.sqrt(l)));for(k=1;k<2*g;k++)d.setValue(k,0),e.setValue(k,0);h.addField(d);h.addField(e);return h},trendIntensityIndex:function(a,g,b,h){var c=new TASDK.Recordset,d=a.recordCount,e=new TASDK.Field;e.initialize(d,h);h=new TASDK.MovingAverage;g=h.VIDYA(a,g,0.65,"x").getField("x");a=h.VIDYA(a,b,0.65,"x").getField("x");for(h=1;h<d+1;h++)e.setValue(h,100*(Math.abs(g.value(h)-a.value(h))/a.value(h)));for(h=1;h<b+1;h++)e.setValue(h,0);c.addField(e);return c},twiggsMoneyFlow:function(a,g,b){var h=new TASDK.Recordset,c=a.getFieldByIndex(0).recordCount,d=new TASDK.Field;d.initialize(c,b);var e=a.getField("High"),f=a.getField("Low"),k=a.getField("Close"),l=a.getField("Volume"),n=new TASDK.MovingAverage;a=n.exponentialMovingAverage(a.getField("Volume"),g,"x").getField("x");var m=new TASDK.Field,p=new TASDK.Field;p.initialize(c,"x");m.initialize(c,"x");for(var q=2;q<c+1;q++)m.setValue(q,Math.max(e.value(q),k.value(q-1))),p.setValue(q,Math.min(f.value(q),k.value(q-1)));for(q=2;q<c+1;q++)d.setValue(q,(k.value(q)-p.value(q)-(m.value(q)-k.value(q)))/(m.value(q)-p.value(q))*l.value(q));d=n.exponentialMovingAverage(d,g,b).getField(b);for(q=2;q<c+1;q++)d.setValue(q,d.value(q)/a.value(q));for(q=1;q<g+1;q++)d.setValue(q,0);h.addField(d);return h}};TASDK.LinearRegression=function(){};TASDK.LinearRegression.prototype={regression:function(a,g){var b=0,h=[],c=0,d=h=b=0,e=0,f=0,k=0,l=d=0,n=c=f=e=0,m=new TASDK.Recordset,p=c=0,q=0,f=0,q=a.recordCount,r=new TASDK.Field;r.initialize(q,"Slope");var s=new TASDK.Field;s.initialize(q,"Intercept");var t=new TASDK.Field;t.initialize(q,"Forecast");var u=new TASDK.Field;u.initialize(q,"RSquared");d=1;for(p=g;p<q+1;p++){b=g;h=Array(b+1);d=p-g+1;for(f=1;f<g+1;f++)c=a.value(d),h[f]=c,d++;l=d=k=f=e=0;for(c=1;c<b+1;c++)e+=c,f+=h[c],k+=c*c,d+=h[c]*h[c],l+=h[c]*c;c=b;b=l-e*f/c;h=k-e*e/c;d-=f*f/c;e=b/h;f=1/c*f-parseInt(c/2)*e;c=c*e+f;b*b&&h*d&&(n=b*b/(h*d));p>g&&(r.setValue(p,e),s.setValue(p,f),t.setValue(p,c),u.setValue(p,n))}m.addField(r);m.addField(s);m.addField(t);m.addField(u);return m},timeSeriesForecast:function(a,g,b){a=this.regression(a,g);a.renameField("Forecast",b);a.removeField("Slope");a.removeField("Intercept");a.removeField("RSquared");return a}};TASDK.MovingAverage=function(){};TASDK.MovingAverage.prototype={simpleMovingAverage:function(a,g,b){var h=0,c=0,d=0,e=0,h=0,f,k=new TASDK.Recordset,e=a.recordCount;f=new TASDK.Field;f.initialize(e,b);for(d=b=h=g+1;d<e+1;d++){h=0;for(c=1;c<g+1;c++)h+=a.value(b),b--;b+=g;h/=g;f.setValue(b,h);b++}k.addField(f);return k},exponentialMovingAverage:function(a,g,b){var h=0,c=0,d=0,e=0,f=0,k,l=new TASDK.Recordset,d=a.recordCount;k=new TASDK.Field;k.initialize(d,b);e=2/(g+1);for(c=1;c<g+1;c++)h+=a.value(c);h/=g;f=a.value(c)*(1-e)+h*e;k.setValue(g,f);for(c=g+1;c<d+1;c++)f=k.value(c-1)*(1-e)+a.value(c)*e,k.setValue(c,f);l.addField(k);return l},timeSeriesMovingAverage:function(a,g,b){var h=null,h=new TASDK.LinearRegression,c=0,d=0,e=0,f,d=a.recordCount;f=new TASDK.Field;f.initialize(d,b);h=h.regression(a,g);for(c=1;c<d+1;c++)e=h.value("Forecast",c),f.setValue(c,e);h.addField(f);return h},variableMovingAverage:function(a,g,b){var h=new TASDK.Oscillator,c=g=0,d=0,e=d=0,f=0,k,c=a.recordCount;k=new TASDK.Field;k.initialize(c,b);b=h.chandeMomentumOscillator(a,9,"CMO");for(g=2;g<c+1;g++)e=k.value(g-1),d=b.value("CMO",g)/100,f=a.value(g),0>d&&(d*=-1),d=d*f+(1-d)*e,k.setValue(g,d);b.addField(k);return b},triangularMovingAverage:function(a,g,b){var h=0,c=0,d=0,e=0,f=0,k=0,l=0,n,m,p=new TASDK.Recordset,c=a.recordCount;n=new TASDK.Field;n.initialize(c,"MA1");m=new TASDK.Field;m.initialize(c,b);0<g%2?k=f=parseInt(g/2)+1:(f=g/2,k=f+1);for(h=g=d=g+1;h<c+1;h++){l=0;for(e=1;e<f+1;e++)l+=a.value(g),g--;g+=parseInt(f);l/=f;n.setValue(g,l);g++}for(h=g=d;h<c+1;h++){l=0;for(e=1;e<k+1;e++)l+=n.value(g),g--;g+=parseInt(k);l/=k;m.setValue(g,l);g++}p.addField(m);return p},weightedMovingAverage:function(a,g,b){var h=0,c=0,d=0,e=h=0,f=0,k,l=new TASDK.Recordset,f=a.recordCount;k=new TASDK.Field;k.initialize(f,b);for(d=1;d<g+1;d++)c+=d;for(e=b=h=g+1;e<f+1;e++){h=0;for(d=g;0<d;d--)h+=d*a.value(b),b--;b+=g;h/=c;k.setValue(b,h);b++}l.addField(k);return l},VIDYA:function(a,g,b,h){var c=0,d=0,e=c=0,f=0,k,c=new TASDK.LinearRegression,d=a.recordCount;k=new TASDK.Field;k.initialize(d,h);g=c.regression(a,g);for(h=c=2;c<d+1;c++)f=a.value(h-1),e=g.value("RSquared",h)*b,k.setValue(h,e*a.value(h)+(1-e)*f),h++;g.addField(k);return g},wellesWilderSmoothing:function(a,g,b){var h,c=new TASDK.Recordset,d=0,e=0,f=0,e=a.recordCount;h=new TASDK.Field;h.initialize(e,b);for(d=2;d<e+1;++d)f=h.value(d-1)+1/g*(a.value(d)-h.value(d-1)),h.setValue(d,f);c.addField(h);return c},movingAverageSwitch:function(a,g,b,h){var c=null;switch(b){case 0:c=this.simpleMovingAverage(a,g,h);break;case 1:c=this.exponentialMovingAverage(a,g,h);break;case 2:c=this.timeSeriesMovingAverage(a,g,h);break;case 3:c=this.triangularMovingAverage(a,g,h);break;case 4:c=this.variableMovingAverage(a,g,h);break;case 7:c=this.weightedMovingAverage(a,g,h);break;case 5:c=this.VIDYA(a,g,0.65,h);break;case 6:c=this.wellesWilderSmoothing(a,g,h)}return c}};TASDK.Oscillator=function(){};TASDK.Oscillator.prototype={chandeMomentumOscillator:function(a,g,b){var h,c=new TASDK.Recordset,d=0,e=0,f=0,k=0,l=0,n=0,m=0,f=0,e=a.recordCount;h=new TASDK.Field;h.initialize(e,b);b=1;for(d=g+2;d<e+2;d++){b=d-g;m=n=0;for(f=1;f<g+1;f++)l=a.value(b-1),k=a.value(b),k>l?n+=k-l:k<l&&(m+=l-k),b++;f=n+m?100*(n-m)/(n+m):TASDKConst.nullValue;h.setValue(b-1,f)}c.addField(h);return c},momentum:function(a,g,b){var h=new TASDK.Recordset,c,d=0,e=0,f=e=0,d=a.recordCount;c=new TASDK.Field;c.initialize(d,b);for(b=e=g+2;e<d+1;e++)f=a.value(b-g),f=100+(a.value(b)-f)/f*100,c.setValue(b,f),b++;h.addField(c);return h},TRIX:function(a,g,b){var h=new TASDK.MovingAverage,c=new TASDK.Recordset,d,e,f=d=0,k=f=0;d=h.exponentialMovingAverage(a,g,"EMA1");e=d.getField("EMA1");d.removeField("EMA1");d=h.exponentialMovingAverage(e,g,"EMA2");e=d.getField("EMA2");d.removeField("EMA2");d=h.exponentialMovingAverage(e,g,"EMA3");e=d.getField("EMA3");d.removeField("EMA3");d=a.recordCount;a=new TASDK.Field;a.initialize(d,b);for(b=f=2;f<d+1;f++){if(k=e.value(b-1))k=(e.value(b)-k)/k*100,a.setValue(b,k);b++}c.addField(a);return c},ultimateOscillator:function(a,g,b,h,c){var d=new TASDK.Recordset,e,f=0,k=0,l=0,n=l=k=k=0,m=n=0,p=0,q=0,r=0,s=0,t=0,u=0,f=a.getFieldByIndex(0).recordCount;e=new TASDK.Field;e.initialize(f,c);k=g;b>k&&(k=b);h>k&&(k=h);for(c=k+=2;k<f+2;k++){u=t=s=r=q=p=0;c=k-g;for(l=1;l<g+1;l++)n=a.getField("Low").value(c)<a.getField("Close").value(c-1)?a.getField("Low").value(c):a.getField("Close").value(c-1),n=a.getField("Close").value(c)-n,m=a.getField("High").value(c)-a.getField("Low").value(c),m<a.getField("High").value(c)-a.getField("Close").value(c-1)&&(m=a.getField("High").value(c)-a.getField("Close").value(c-1)),m<a.getField("Close").value(c-1)-a.getField("Low").value(c)&&(m=a.getField("Close").value(c-1)-a.getField("Low").value(c)),p+=n,s+=m,c++;c-=b;for(l=1;l<b+1;l++)n=a.getField("Low").value(c)<a.getField("Close").value(c-1)?a.getField("Low").value(c):a.getField("Close").value(c-1),n=a.getField("Close").value(c)-n,m=a.getField("High").value(c)-a.getField("Low").value(c),m<a.getField("High").value(c)-a.getField("Close").value(c-1)&&(m=a.getField("High").value(c)-a.getField("Close").value(c-1)),m<a.getField("Close").value(c-1)-a.getField("Low").value(c)&&(m=a.getField("Close").value(c-1)-a.getField("Low").value(c)),q+=n,t+=m,c++;c-=h;for(l=1;l<h+1;l++)n=a.getField("Low").value(c)<a.getField("Close").value(c-1)?a.getField("Low").value(c):a.getField("Close").value(c-1),n=a.getField("Close").value(c)-n,m=a.getField("High").value(c)-a.getField("Low").value(c),m<a.getField("High").value(c)-a.getField("Close").value(c-1)&&(m=a.getField("High").value(c)-a.getField("Close").value(c-1)),m<a.getField("Close").value(c-1)-a.getField("Low").value(c)&&(m=a.getField("Close").value(c-1)-a.getField("Low").value(c)),r+=n,u+=m,c++;l=(p/s*4+q/t*2+r/u)/7*100;e.setValue(c-1,l)}d.addField(e);return d},verticalHorizontalFilter:function(a,g,b){var h,c=new TASDK.Recordset,d=0,e=0,f=0,k=d=0,l=0,n=0,m=0,e=a.recordCount;h=new TASDK.Field;h.initialize(e,b);for(b=d=g+2;d<e+2;d++){k=0;l=a.value(b);b=d-g;for(f=1;f<g+1;f++)a.value(b)<l?l=a.value(b):a.value(b)>k&&(k=a.value(b)),b++;n=0;b=d-g;for(f=1;f<g+1;f++)m=a.value(b)-a.value(b-1),0>m&&(m*=-1),n+=m,b++;m=(k-l)/n;0>m&&(m*=-1);h.setValue(b-1,m)}c.addField(h);return c},williamsPctR:function(a,g,b){var h,c=new TASDK.Recordset,d=0,e=0,f=0,k=d=0,l=0,e=a.getFieldByIndex(0).recordCount;h=new TASDK.Field;h.initialize(e,b);for(b=d=g+2;d<e+2;d++){k=0;l=a.getField("Low").value(b);b=d-g;for(f=1;f<g+1;f++)a.getField("High").value(b)>k&&(k=a.getField("High").value(b)),a.getField("Low").value(b)<l&&(l=a.getField("Low").value(b)),b++;h.setValue(b-1,(k-a.getField("Close").value(b-1))/(k-l)*-100)}c.addField(h);return c},williamsAccumulationDistribution:function(a,g){var b=new TASDK.Recordset,h,c=0,d=0,e=0,f=0,e=0,c=a.getFieldByIndex(0).recordCount;h=new TASDK.Field;h.initialize(c,g);for(var k=2,d=1;d<c;d++)e=a.getField("Close").value(k-1),a.getField("High").value(k)>e&&(e=a.getField("High").value(k)),f=a.getField("Close").value(k-1),a.getField("Low").value(k)<f&&(f=a.getField("Low").value(k)),e=a.getField("Close").value(k)>a.getField("Close").value(k-1)?a.getField("Close").value(k)-f:a.getField("Close").value(k)<a.getField("Close").value(k-1)?a.getField("Close").value(k)-e:0,h.setValue(k,e+h.value(k-1)),k++;b.addField(h);return b},volumeOscillator:function(a,g,b,h,c){var d,e=new TASDK.MovingAverage,f=new TASDK.Recordset,k=0,l=0,n=0,l=a.recordCount;d=new TASDK.Field;d.initialize(l,c);g=e.simpleMovingAverage(a,g,"MA1");a=e.simpleMovingAverage(a,b,"MA2");for(k=b=1;k<l+1;k++)1===h?n=g.getField("MA1").value(b)-a.getField("MA2").value(b):2===h&&0<a.getField("MA2").value(b)&&(n=(g.getField("MA1").value(b)-a.getField("MA2").value(b))/a.getField("MA2").value(b)*100),d.setValue(k,n),b++;f.addField(d);return f},chaikinVolatility:function(a,g,b,h,c){var d,e=new TASDK.MovingAverage,f=new TASDK.Recordset,k=null,l=0,n=0,m=l=0,p=0,q=0,n=a.getFieldByIndex(0).recordCount;d=new TASDK.Field;d.initialize(n,c);k=new TASDK.Field;k.initialize(n,"HL");for(l=c=1;l<n+1;l++)k.setValue(c,a.getField("High").value(c)-a.getField("Low").value(c)),c++;k=e.movingAverageSwitch(k,g,h,"HLMA");for(c=l=b+1;l<n+1;l++)p=k.getField("HLMA").value(c-b),q=k.getField("HLMA").value(c),p&&q&&(m=(p-q)/p*-100),d.setValue(l,m),c++;f.addField(d);return f},stochasticOscillator:function(a,g,b,h,c){var d=new TASDK.MovingAverage,e=null,e=null,f=new TASDK.Recordset,k=0,l=0,n=0,m=k=0,p=0,n=0,l=a.getFieldByIndex(0).recordCount,e=new TASDK.Field;e.initialize(l,"%K");for(var q=k=g+2;k<l+2;k++){q=k-g;p=a.getField("High").value(q);m=a.getField("Low").value(q);for(n=1;n<g+1;n++)a.getField("High").value(q)>p&&(p=a.getField("High").value(q)),a.getField("Low").value(q)<m&&(m=a.getField("Low").value(q)),q++;n=(a.getField("Close").value(q-1)-m)/(p-m)*100;e.setValue(q-1,n)}1<b?f=d.movingAverageSwitch(e,b,c,"%K"):f.addField(e);e=f.getField("%K");e=d.movingAverageSwitch(e,h,c,"%D");null!=e&&(f.addField(e.getField("%D")),e.removeField("%D"));return f},priceOscillator:function(a,g,b,h,c){var d=new TASDK.Recordset,e,f=new TASDK.MovingAverage,k=null,l=null,n=0,m=0,p=m=0;if(g<=b)return d;n=a.recordCount;e=new TASDK.Field;e.initialize(n,c);k=f.movingAverageSwitch(a,g,h,"MA");l=f.movingAverageSwitch(a,b,h,"MA");for(a=m=g>b?g:b>g?b:g;m<n+1;m++)g=k.value("MA",a),p=0==g?0:(l.value("MA",a)-k.value("MA",a))/g*100,e.setValue(a,p),a++;d.addField(e);return d},MACD:function(a,g,b,h,c,d){var e=new TASDK.Recordset,f,k=new TASDK.MovingAverage,l=0,n=0,m=0,l=a.recordCount;f=new TASDK.Field;f.initialize(l,d);b=k.movingAverageSwitch(a,b,c,"MA");a=k.movingAverageSwitch(a,h,c,"MA");for(n=1;n<l+1;n++)m=a.value("MA",n)-b.value("MA",n),f.setValue(n,m);b=k.movingAverageSwitch(f,g,c,"MA");g=b.getField("MA");g.name=d+"Signal";e.addField(f);e.addField(g);b.removeField(d+"Signal");return e},macdHistogram:function(a,g,b,h,c,d){var e=new TASDK.Recordset,f,k=new TASDK.MovingAverage,l=0,n=0,m=0,l=a.recordCount;f=new TASDK.Field;f.initialize(l,d);b=k.movingAverageSwitch(a,b,c,"MA");a=k.movingAverageSwitch(a,h,c,"MA");for(n=1;n<l+1;n++)m=a.value("MA",n)-b.value("MA",n),f.setValue(n,m);b=k.movingAverageSwitch(f,g,c,"MA");g=b.getField("MA");g.name=d+"Signal";c=new TASDK.Field;c.initialize(l,d);for(n=1;n<l+1;n++)m=f.value(n)-g.value(n),c.setValue(n,m);e.addField(c);b.removeField(d+"Signal");return e},easeOfMovement:function(a,g,b,h){var c=new TASDK.MovingAverage,d=new TASDK.Recordset,e=null,f=null,k=e=0,l=k=0,n=l=0,m=0,e=a.getFieldByIndex(0).recordCount,f=new TASDK.Field;f.initialize(e,h);for(var p=k=2;k<e+1;k++)l=(a.value("High",p)+a.value("Low",p))/2-(a.value("High",p-1)+a.value("Low",p-1))/2,(m=a.value("High",p)-a.value("Low",p))&&(n=a.value("Volume",p)/m),l/=n,f.setValue(p,1E4*l),p++;e=c.movingAverageSwitch(f,g,b,"MA");null!=e&&(f=e.getField("MA"),f.name=h,e.removeField(h));d.addField(f);return d},detrendedPriceOscillator:function(a,g,b,h){var c=new TASDK.MovingAverage,d=new TASDK.Recordset,e=null,f=null,k=0,l=0,l=0,k=a.recordCount,f=new TASDK.Field;f.initialize(k,h);e=c.movingAverageSwitch(a,g,b,"MA");for(b=l=g+1;l<k+1;l++)f.setValue(b,a.value(b)-e.value("MA",b-(g/2+1))),b++;d.addField(f);return d},parabolicSAR:function(a,g,b,h,c){var d=new TASDK.Recordset,e,f=0,k=0,l=k=0,n=0,m=0,p=0,q=0,r=0,s=n=m=0,t=0,u=0,f=a.recordCount;e=new TASDK.Field;e.initialize(f,c);k=2;n=a.value(1);m=g.value(1);a.value(2)-a.value(1)<g.value(2)-g.value(1)?(p=n,l=-1):(p=m,l=1);q=b;r=p;s=m;t=n;u=s;for(m=b;k<f+1;++k)1===l?(a.value(k)>n&&(n=a.value(k),m<h&&(m+=b)),r=p+q*(t-p),g.value(k)<r&&(l=-1,m=b,r=t,n=0,s=g.value(k))):-1===l&&(g.value(k)<s&&(s=g.value(k),m<h&&(m+=b)),r=p+q*(u-p),a.value(k)>r&&(l=1,m=b,r=u,s=0,n=a.value(k))),t=n,u=s,p=r,q=m,e.setValue(k,r);d.addField(e);return d},directionalMovementSystem:function(a,g){var b=new TASDK.MovingAverage,h=new TASDK.Recordset,c=new TASDK.Recordset,d,e,f,k,l,n,m=0,p=0,q=0;d=e=0;q=a.getFieldByIndex(0).recordCount;l=this.trueRange(a,"TR");k=l.getField("TR");l.removeField("TR");n=b.wellesWilderSmoothing(k,g,"TRSum");f=new TASDK.Field;f.initialize(q,"UpDMI");d=new TASDK.Field;d.initialize(q,"DnDMI");k=new TASDK.Field;k.initialize(q,"DI-");l=new TASDK.Field;l.initialize(q,"DI+");for(e=2;e!==q+1;++e)m=a.value("High",e)-a.value("High",e-1),p=a.value("Low",e-1)-a.value("Low",e),0>m&&0>p||m===p?(f.setValue(e,0),d.setValue(e,0)):m>p?(f.setValue(e,m),d.setValue(e,0)):m<p&&(f.setValue(e,0),d.setValue(e,p));f=b.wellesWilderSmoothing(f,g,"DM+Sum");b=b.wellesWilderSmoothing(d,g,"DM-Sum");for(e=2;e!==q+1;++e)l.setValue(e,Math.floor(100*f.value("DM+Sum",e)/n.value("TRSum",e))),k.setValue(e,Math.floor(100*b.value("DM-Sum",e)/n.value("TRSum",e)));b=new TASDK.Field;b.initialize(q,"DX");for(e=2;e!==q+1;++e)d=Math.abs(parseInt(l.value(e)-k.value(e))),f=l.value(e)+k.value(e),0<d&&0<f&&b.setValue(e,Math.floor(d/f*100));e=new TASDK.Field;e.initialize(q,"ADX");c.addField(e);for(e=g+1;e!==q+1;++e)d=Math.floor((c.value("ADX",e-1)*(g-1)+b.value(e))/g+0.5),c.getField("ADX").setValue(e,d);d=new TASDK.Field;d.initialize(q,"ADXR");for(e=g+1;e!==q+1;++e)d.setValue(e,Math.floor((c.value("ADX",e)+c.value("ADX",e-1))/2)+0.5);h.addField(c.getField("ADX"));h.addField(d);h.addField(b);h.addField(n.getField("TRSum"));h.addField(k);h.addField(l);c.removeField("ADX");c.removeField("ADXF");n.removeField("TRSum");return h},trueRange:function(a,g){var b=new TASDK.Recordset,h,c=0,d=0,e=0,f=0,k=0,l=0,c=a.getFieldByIndex(0).recordCount;h=new TASDK.Field;h.initialize(c,g);for(d=2;d!==c+1;++d)e=a.value("High",d)-a.value("Low",d),f=Math.abs(a.value("High",d)-a.value("Close",d-1)),k=Math.abs(a.value("Close",d-1)-a.value("Low",d)),l=0,e>l&&(l=e),f>l&&(l=f),k>l&&(l=k),h.setValue(d,l);h.name=g;b.addField(h);return b},aroon:function(a,g){var b=new TASDK.Recordset,h,c,d,e=0,f=0,k=0,l=0,n=0,m=0,p=0,e=a.getFieldByIndex(0).recordCount;h=new TASDK.Field;h.initialize(e,"Aroon Up");c=new TASDK.Field;c.initialize(e,"Aroon Down");d=new TASDK.Field;d.initialize(e,"Aroon Oscillator");for(f=g+1;f!==e+1;++f){l=a.value("High",f);n=a.value("Low",f);p=m=f;for(k=f-g;k!==f;++k)a.value("High",k)>l&&(l=a.value("High",k),m=k),a.value("Low",k)<n&&(n=a.value("Low",k),p=k);h.setValue(f,(g-(f-m))/g*100);c.setValue(f,(g-(f-p))/g*100);d.setValue(f,h.value(f)-c.value(f))}b.addField(h);b.addField(c);b.addField(d);return b},rainbowOscillator:function(a,g,b,h){var c=new TASDK.MovingAverage,d=new TASDK.Recordset,e=null,f,k=0,l=0,n=0,m=0,k=a.recordCount;f=new TASDK.Field;f.initialize(k,h);for(n=2;n!==g+1;++n)for(e=c.movingAverageSwitch(a,g,b,"MA"),l=1;l!==k+1;++l)m=e.value("MA",l),f.setValue(l,a.value(l)-m+f.value(l));for(l=1;l!==k+1;++l)f.value(l),f.setValue(l,f.value(l)/g);d.addField(f);return d},fractalChaosOscillator:function(a,g,b){g=new TASDK.Recordset;var h=a.getFieldByIndex(0).recordCount,c=0,d=a.getField("High");a=a.getField("Low");var e=new TASDK.Field;e.initialize(h,"FR");var f=new TASDK.Field;f.initialize(h,"High 1");var k=new TASDK.Field;k.initialize(h,"High 2");var l=new TASDK.Field;l.initialize(h,"High 3");var n=new TASDK.Field;n.initialize(h,"High 4");var m=new TASDK.Field;m.initialize(h,"Low 1");var p=new TASDK.Field;p.initialize(h,"Low 2");var q=new TASDK.Field;q.initialize(h,"Low 3");var r=new TASDK.Field;r.initialize(h,"Low 4");for(c=5;c<h+1;++c)f.setValue(c,d.value(c-4)),m.setValue(c,a.value(c-4)),k.setValue(c,d.value(c-3)),p.setValue(c,a.value(c-3)),l.setValue(c,d.value(c-2)),q.setValue(c,a.value(c-2)),n.setValue(c,d.value(c-1)),r.setValue(c,a.value(c-1));for(c=2;c<h+1;++c)l.value(c)>f.value(c)&&l.value(c)>k.value(c)&&l.value(c)>=n.value(c)&&l.value(c)>=d.value(c)&&e.setValue(c,1),q.value(c)<m.value(c)&&q.value(c)<p.value(c)&&q.value(c)<=r.value(c)&&q.value(c)<=a.value(c)&&e.setValue(c,-1);e.name=b;g.addField(e);return g},primeNumberOscillator:function(a,g){var b=new TASDK.Recordset,h=a.recordCount,c=0,d=new TASDK.Field;d.initialize(h,g);for(var e=new TASDK.General,f=0,k=0,l=0,n=0,c=1;c!==h+1;++c){k=a.value(c);10>k&&(k*=10);for(f=k;1!==f;--f)if(e.isPrime(f)){n=f;break}for(f=k;f!==2*k;++f)if(e.isPrime(f)){l=f;break}Math.abs(k-l)<Math.abs(k-n)?d.setValue(c,k-l):d.setValue(c,k-n)}b.addField(d);return b},elderRay:function(a,g,b,h){var c=new TASDK.Recordset,d=a.getFieldByIndex(0).recordCount;1>g&&(g=13);var e=new TASDK.Field,f=new TASDK.Field;e.initialize(d,h+" Bull Power");f.initialize(d,h+" Bear Power");var k=a.getField("Close");h=a.getField("High");a=a.getField("Low");b=(new TASDK.MovingAverage).movingAverageSwitch(k,g,b,"ema").getField("ema");for(g+=1;g<d+1;g++)e.setValue(g,h.value(g)-b.value(g)),f.setValue(g,b.value(g)-a.value(g));c.addField(e);c.addField(f);return c},ehlerFisherTransform:function(a,g,b){var h=new TASDK.Recordset;1>g&&(g=10);var c=a.getFieldByIndex(0).recordCount,d=new TASDK.Field;d.initialize(c,b);var e=new TASDK.Field;e.initialize(c,b+" Trigger");var f=new TASDK.General;a=f.medianPrice(a,"price").getField("price");b=f.HHV(a,g,"maxh").getField("maxh");g=f.LLV(a,g,"minl").getField("minl");for(var k=0,f=k=0,l=1;l<c+1;l++){var n=b.value(l),m=g.value(l),k=n!==m?0.66*((a.value(l)-m)/(n-m)-0.5)+0.67*k:0;0.99<k&&(k=0.999);-0.99>k&&(k=-0.999);n=0.5*Math.log((1+k)/(1-k))+0.5*f;d.setValue(l,n);e.setValue(l,f);f=n}h.addField(d);h.addField(e);return h},schaffTrendCycle:function(a,g,b,h,c,d){var e=new TASDK.Recordset,f=a.recordCount,k=new TASDK.Field;k.initialize(f,"x");var l=new TASDK.Field;l.initialize(f,"x");var n=new TASDK.Field;n.initialize(f,"x");var m=new TASDK.Field;m.initialize(f,d);d=new TASDK.General;h=(new TASDK.Oscillator).MACD(a,2,h,b,c,"x").getField("x");c=d.LLV(h,g,"x").getField("x");a=d.HHV(h,g,"x").getField("x");for(b=1;b<f+1;++b)a.setValue(b,a.value(b)-c.value(b));for(b=2;b<f+1;++b)0<a.value(b)?k.setValue(b,(h.value(b)-c.value(b))/a.value(b)*100):k.setValue(b,k.value(b-1)),n.setValue(b,n.value(b-1)+0.5*(k.value(b)-n.value(b-1)));k=d.LLV(n,g,"x").getField("x");g=d.HHV(n,g,"x").getField("x");for(b=1;b<f+1;++b)g.setValue(b,g.value(b)-k.value(b));for(b=2;b<f+1;++b)0<a.value(b)?l.setValue(b,(n.value(b)-k.value(b))/g.value(b)*100):l.setValue(b,l.value(b-1)),m.setValue(b,m.value(b-1)+0.5*(l.value(b)-m.value(b-1)));e.addField(m);return e},centerOfGravity:function(a,g,b){var h=new TASDK.Recordset,c=a.recordCount,d=new TASDK.Field;d.initialize(c,b);for(b=g+1;b<c+1;++b){for(var e=0,f=0,k=1,l=b-1;l>b-g;--l)e+=a.value(l)*(k+1),f+=a.value(l),k++;d.setValue(b,-1*e/f)}h.addField(d);return h},coppockCurve:function(a,g){new TASDK.Recordset;var b=a.recordCount,h=new TASDK.Field;h.initialize(b,g);for(var c=new TASDK.General,d=c.priceROC(a,14,"x").getField("x"),c=c.priceROC(a,11,"x").getField("x"),e=1;e<b+1;++e)h.setValue(e,d.value(e)+c.value(e));return(new TASDK.MovingAverage).weightedMovingAverage(h,10,g)},chandeForecastOscillator:function(a,g,b){var h=new TASDK.Recordset,c=a.recordCount,d=new TASDK.Field;d.initialize(c,b);b=(new TASDK.LinearRegression).timeSeriesForecast(a,g,"x").getField("x");for(var e=1;e<c+1;++e)d.setValue(e,(a.value(e)-b.value(e))/a.value(e)*100);for(e=1;e<g+1;++e)d.setValue(e,0);h.addField(d);return h},klingerVolumeOscillator:function(a,g,b,h,c,d){new TASDK.Recordset;var e=a.getFieldByIndex(0).recordCount;(new TASDK.Field).initialize(e,d);var f=a.getField("Volume");a=(new TASDK.General).typicalPrice(a,"x").getField("x");var k=new TASDK.Field;k.initialize(e,"sv");for(var l=2;l<e+1;l++)a.value(l)>=a.value(l-1)?k.setValue(l,f.value(l)):k.setValue(l,-1*f.value(l));return(new TASDK.Oscillator).MACD(k,g,b,h,c,d)},prettyGoodOscillator:function(a,g,b){var h=new TASDK.Recordset,c=a.getFieldByIndex(0).recordCount,d=new TASDK.Field;d.initialize(c,b);b=a.getField("Close");(new TASDK.Field).initialize(c,"sv");var e=new TASDK.MovingAverage,f=e.simpleMovingAverage(a.getField("Close"),g,"x").getField("x");a=this.trueRange(a,"x").getField("x");a=e.exponentialMovingAverage(a,g,"x").getField("x");for(e=2;e<c+1;e++)0!=a.value(e)?d.setValue(e,(b.value(e)-f.value(e))/a.value(e)):d.setValue(0);for(e=1;e<g+1;++e)d.setValue(e,0);h.addField(d);return h}};TASDKConst.nullValue=-987653421;TASDKConst.mA_START=0;TASDKConst.mA_END=7;TASDKConst.simpleMovingAverage=0;TASDKConst.exponentialMovingAverage=1;TASDKConst.timeSeriesMovingAverage=2;TASDKConst.triangularMovingAverage=3;TASDKConst.variableMovingAverage=4;TASDKConst.VIDYA=5;TASDKConst.wellesWilderSmoothing=6;TASDKConst.weightedMovingAverage=7})();